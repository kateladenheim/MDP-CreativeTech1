<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>potValue</title>
</head>
<body>
    <script src="https://cdn.jsdelivr.net/npm/p5@1.0.0/lib/p5.js"></script>
    <script>
        let url = "https://api.particle.io/v1/devices/3b0034000147393033373334/pot_value?access_token=0a53d6dbef8d0532ff9136adb3d3ae6606198ae3";
        let data = "";
        let currentTime, prevTime;
        let value = 10;

        function setup () {
            createCanvas(400, 400);
        }

        function draw () { 
            background(255);

            currentTime = millis () % 1000;
            if(currentTime < prevTime){
                data = loadJSON(url, processData);
                }

            fill(255, 0, 0);    
               circle(width/2, height/2, value);
            
            prevTime = currentTime;
        }

        function processData(data) {
            console.log(data.result);
            value = map(parseInt(data.result), 0, 4096, 0, width);
            console.log(value);
        }

    </script>
</body>
</html>